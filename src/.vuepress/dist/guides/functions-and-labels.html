<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Functions and Labels | Wiz</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A high-level assembly language for retro console platforms.">
    
    <link rel="preload" href="/assets/css/0.styles.9443be11.css" as="style"><link rel="preload" href="/assets/js/app.fbc1217a.js" as="script"><link rel="preload" href="/assets/js/2.ace28840.js" as="script"><link rel="preload" href="/assets/js/10.ff72bf06.js" as="script"><link rel="prefetch" href="/assets/js/11.e38e966f.js"><link rel="prefetch" href="/assets/js/12.f41e92e5.js"><link rel="prefetch" href="/assets/js/13.8dd25aad.js"><link rel="prefetch" href="/assets/js/14.d644e451.js"><link rel="prefetch" href="/assets/js/15.4eb04e4c.js"><link rel="prefetch" href="/assets/js/16.c33f1f08.js"><link rel="prefetch" href="/assets/js/3.5e04ea21.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.5b34f445.js"><link rel="prefetch" href="/assets/js/8.38db3e09.js"><link rel="prefetch" href="/assets/js/9.83d99b72.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9443be11.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Wiz</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/wiz-lang/wiz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/wiz-lang/wiz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/building-source.html" class="sidebar-link">Building Source</a></li><li><a href="/usage.html" class="sidebar-link">Using Wiz</a></li><li><a href="/quick-guide.html" class="sidebar-link">Quick guide</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guides</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/syntax.html" class="sidebar-link">Syntax</a></li><li><a href="/guides/types.html" class="sidebar-link">Types</a></li><li><a href="/guides/functions-and-labels.html" aria-current="page" class="active sidebar-link">Functions and Labels</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#functions" class="sidebar-link">Functions</a></li><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#return-statements" class="sidebar-link">Return Statements</a></li><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#call-statement" class="sidebar-link">Call Statement</a></li><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#tail-call-statements" class="sidebar-link">Tail-Call Statements</a></li><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#labels" class="sidebar-link">Labels</a></li><li class="sidebar-sub-header"><a href="/guides/functions-and-labels.html#inline-functions" class="sidebar-link">Inline Functions</a></li></ul></li><li><a href="/guides/control-flow.html" class="sidebar-link">Control Flow</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="functions-and-labels"><a href="#functions-and-labels" class="header-anchor">#</a> Functions and Labels</h1> <h2 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h2> <p>A function is a piece of code that performs a specific set of actions and operations. They can be executed by other parts of the program, and can take arguments and produce a return value.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">arg </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> arg2 </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> arg3 </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type3</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> return_type </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">poke</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u16</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">hl</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> value </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">*(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*u8)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">sum</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">left </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> right </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">c</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> left </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> right</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="return-statements"><a href="#return-statements" class="header-anchor">#</a> Return Statements</h2> <p>A <code>return</code> statement is used to return from the currently executing function.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">return;</span></span>
<span class="line"><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>If used in a function that has no return type, it cannot have a return value. If used in a function that has a return type, the return value must be of the same type.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">collect_egg</span><span style="color:#81A1C1;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> egg_count</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&gt;=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#D8DEE9FF;">    egg_count</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">triple</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">value </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>A <code>return</code> that exists outside of any function body is a low-level <code>return</code> instruction. This would pop a location from the stack and jump there.</p> <h2 id="call-statement"><a href="#call-statement" class="header-anchor">#</a> Call Statement</h2> <p>A call statement is a kind of statement that invokes a function. If the function being called produces a return value, the value is discarded. If the function call returns, the code following it will execute. Intrinsic instructions can also be called in the same manner.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#88C0D0;">function</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">argument1</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> argument2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> argument3</span><span style="color:#81A1C1;">);</span></span></code></pre></div><h2 id="tail-call-statements"><a href="#tail-call-statements" class="header-anchor">#</a> Tail-Call Statements</h2> <p>A statement of form <code>return f();</code> is a tail-call statement. It gets subsituted for a <code>goto</code>, and avoids the overhead of subroutine call that would push a program counter to the stack. However, unlike a <code>goto</code>, a tail-call will evaluate arguments to a function, like a normal function call.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">call_subroutine</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u16</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">hl</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*func);</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="labels"><a href="#labels" class="header-anchor">#</a> Labels</h2> <p>Labels are like functions, but will never return, and cannot be passed arguments. As a low-level detail, labels of form <code>f:</code> are effectively the same thing as an empty-fallthrough function <code>#[fallthrough] func f() {}</code> placed directly before whatever code is executed. A label can be used in any bank that has a known address. (An address is currently required, but eventually, this requirement could relaxed to allow banks which use relative addressing only.)</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9FF;">label</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> label</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Labels or functions can be the target of call expressions, or <code>goto</code> statements.</p> <h2 id="inline-functions"><a href="#inline-functions" class="header-anchor">#</a> Inline Functions</h2> <p>An <code>inline func</code> is like <code>func</code> but inlined directly wherever it is used. As a consequence, the contents of the function are inserted wherever it is called, and the function has no address.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">();</span></span></code></pre></div><p>An <code>inline func</code> can still <code>return</code>, like a normal function. However, it will not use the stack. Instead, it will jump to a hidden return label that exists at the end of the function.</p> <p>Because an <code>inline func</code> has no address, an <code>inline func</code> cannot be stored in a function pointer, and cannot be branched to from a <code>goto</code> or tail-call statement.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guides/types.html" class="prev">
        Types
      </a></span> <span class="next"><a href="/guides/control-flow.html">
        Control Flow
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fbc1217a.js" defer></script><script src="/assets/js/2.ace28840.js" defer></script><script src="/assets/js/10.ff72bf06.js" defer></script>
  </body>
</html>
