<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quick guide | Wiz</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A high-level assembly language for retro console platforms.">
    
    <link rel="preload" href="/assets/css/0.styles.9443be11.css" as="style"><link rel="preload" href="/assets/js/app.fbc1217a.js" as="script"><link rel="preload" href="/assets/js/2.ace28840.js" as="script"><link rel="preload" href="/assets/js/15.4eb04e4c.js" as="script"><link rel="prefetch" href="/assets/js/10.ff72bf06.js"><link rel="prefetch" href="/assets/js/11.e38e966f.js"><link rel="prefetch" href="/assets/js/12.f41e92e5.js"><link rel="prefetch" href="/assets/js/13.8dd25aad.js"><link rel="prefetch" href="/assets/js/14.d644e451.js"><link rel="prefetch" href="/assets/js/16.c33f1f08.js"><link rel="prefetch" href="/assets/js/3.5e04ea21.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.f3e6ed41.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.5b34f445.js"><link rel="prefetch" href="/assets/js/8.38db3e09.js"><link rel="prefetch" href="/assets/js/9.83d99b72.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9443be11.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Wiz</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/wiz-lang/wiz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/wiz-lang/wiz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/building-source.html" class="sidebar-link">Building Source</a></li><li><a href="/usage.html" class="sidebar-link">Using Wiz</a></li><li><a href="/quick-guide.html" aria-current="page" class="active sidebar-link">Quick guide</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/quick-guide.html#banks" class="sidebar-link">Banks</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#constants" class="sidebar-link">Constants</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#variables" class="sidebar-link">Variables</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#extern-variables-memory-mapped-i-o-registers" class="sidebar-link">Extern Variables (Memory Mapped I/O Registers)</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#let-definitions" class="sidebar-link">Let Definitions</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#empty-statement" class="sidebar-link">Empty Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#assignment-statement" class="sidebar-link">Assignment Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#call-statement" class="sidebar-link">Call Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#block-statement" class="sidebar-link">Block Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#if-statement" class="sidebar-link">If Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#while-statement" class="sidebar-link">While Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#do-while-statement" class="sidebar-link">Do/While Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#for-statement" class="sidebar-link">For Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#return-statements" class="sidebar-link">Return Statements</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#tail-call-statements" class="sidebar-link">Tail-Call Statements</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#goto-statements" class="sidebar-link">Goto Statements</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#break-and-continue" class="sidebar-link">Break and Continue</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#functions-and-labels" class="sidebar-link">Functions and Labels</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#inline-functions" class="sidebar-link">Inline Functions</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#inline-for-statement" class="sidebar-link">Inline For Statement</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#attributes" class="sidebar-link">Attributes</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#config-directives" class="sidebar-link">Config Directives</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#types" class="sidebar-link">Types</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#expressions" class="sidebar-link">Expressions</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#imports" class="sidebar-link">Imports</a></li><li class="sidebar-sub-header"><a href="/quick-guide.html#embeds" class="sidebar-link">Embeds</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guides</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="quick-guide"><a href="#quick-guide" class="header-anchor">#</a> Quick guide</h1> <p>This is a quick run-down of language features. This section is largely unfinished, so please consult example programs for better documentation!</p> <h2 id="banks"><a href="#banks" class="header-anchor">#</a> Banks</h2> <p>Banks are sections or segments that are used to hold the different pieces of the program, such as variables, constants, or executable code.</p> <p>A bank declaration reserves a bank of memory with a given type and address. It has the following syntax:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">bank</span><span style="color:#D8DEE9FF;"> name </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> address</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> name </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> address</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> name </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> address </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[</span><span style="color:#D8DEE9FF;">type</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> size</span><span style="color:#81A1C1;">];</span></span></code></pre></div><p>The type of bank of <code>bank</code> determines what kind of declarations can be placed there.</p> <ul><li><code>vardata</code> is uninitialized RAM. useful for variables that can be written to and read back at runtime. Because this section is uninitialized, variables declared here must be assigned a value at execution time. Because of these limitations, compiled code and and constant data cannot be placed here.</li> <li><code>prgdata</code> is ROM used for program code and constants. Cannot be written to.</li> <li><code>constdata</code> is ROM used for constants and program code. Cannot be written to.</li> <li><code>chrdata</code> is ROM used for character / tile graphic data. This type of bank has a special meaning on platforms like the NES, where character data is on a separate memory bus. It is otherwise the same as <code>constdata</code>.</li> <li>The distinction between <code>prgdata</code> and <code>constdata</code> will only exist on Harvard architectures, where the program and constant data live on separate buses. Otherwise, just use it for clarifying the purpose of ROM banks, if it matters.</li> <li><code>varinitdata</code> is initialized RAM. Useful for programs with code and data that get uploaded to RAM.</li></ul> <p>The size of a <code>bank</code> is the number of bytes that it will hold. Exceeding this size limitation is considered an error.</p> <p>The address of a <code>bank</code> after the <code>@</code> is optional but if it appears, it must be an integer literal. Without an address, the <code>bank</code> can cannot contain label declarations.</p> <p>After a bank is declared, it must be selected to be used by an <code>in</code> directive.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">bank</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>An address can also be provided to an <code>in</code> directive. If a <code>bank</code> previously had no address, then the address becomes the origin of the <code>bank</code>. However, if a <code>bank</code> previously had an address, the block is seeked ahead for to given address.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">bank</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> address </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#616E88;">// ...</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">bank</span><span style="color:#D8DEE9FF;"> zeropage </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0x00</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[vardata;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">256</span><span style="color:#81A1C1;">];</span></span>

<span class="line"><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> zeropage </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">var</span><span style="color:#D8DEE9FF;"> timer </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="constants"><a href="#constants" class="header-anchor">#</a> Constants</h2> <p>A constant declaration reserves pre-initialized data that can't be written to at run-time. A constant can appear in a ROM bank, such as <code>prgdata</code>, <code>constdata</code>, or <code>chrdata</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> name </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> type </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> value</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> hp </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> wow </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[u8]</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[</span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">6</span><span style="color:#81A1C1;">];</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> egg </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[u16;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">]</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[</span><span style="color:#B48EAD;">12345</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">54321</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">32333</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">49293</span><span style="color:#81A1C1;">];</span></span></code></pre></div><p>If the type is provided, the initializer is narrowed to the type provided. This means that integer initializers of type <code>iexpr</code> that have no size can be implicitly narrowed to sized integer types like <code>u8</code>, and array initializers of type <code>[iexpr]</code> can be narrowed to <code>[u8]</code>, and so on.</p> <p>Note that The size of an array type can be left off, if the tyep.</p> <p>If the type of a constant can be inferred from the value, then the type can be left off. However, only types with a known size can be constants. <code>iexpr</code> has unknown size, so type-suffixes on integers may be required.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> length </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100u8</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> message </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;HELLO WORLD&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> table </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">embed</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;table.bin&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>The name of a constant is also optional, when placing data in the ROM is desired but a label to it isn't needed.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">embed</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;hero.chr&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Array comprehensions are a nice way to generate tables of data.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> tripled_values </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[u8]</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[</span><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> x </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">49</span><span style="color:#81A1C1;">];</span></span></code></pre></div><h2 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h2> <p>A variable declaration reserves a space for mutable storage. A variable can appear either in RAM bank such as <code>vardata</code>, or <code>varinitdata</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">var</span><span style="color:#D8DEE9FF;"> x </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8;</span></span></code></pre></div><p>A variable declared in a <code>varinitdata</code> bank is allowed to have a initializer.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">var</span><span style="color:#D8DEE9FF;"> x </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span></code></pre></div><p>If an initializer is given, the type can be omitted if the initializer expression has a type of known size.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">var</span><span style="color:#D8DEE9FF;"> x </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">var</span><span style="color:#D8DEE9FF;"> message </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;hello&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span></code></pre></div><p>A variable declared in a <code>vardata</code> bank, on the other hand, is reserved in uninitialized RAM, so it cannot have an initializer and can only be assigned a value at run-time.</p> <h2 id="extern-variables-memory-mapped-i-o-registers"><a href="#extern-variables-memory-mapped-i-o-registers" class="header-anchor">#</a> Extern Variables (Memory Mapped I/O Registers)</h2> <p>An <code>extern</code> variable can be used to declare a piece of external storage that exists at a specific address. Its primary use is for defining memory-mapped I/O registers on a system, so that they can referenced by name.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">extern var</span><span style="color:#D8DEE9FF;"> reg </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0xF000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// read/write</span></span>
<span class="line"><span style="color:#81A1C1;">extern writeonly</span><span style="color:#D8DEE9FF;"> reg2 </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0xF001</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// write-only</span></span>
<span class="line"><span style="color:#81A1C1;">extern const</span><span style="color:#D8DEE9FF;"> reg3 </span><span style="color:#81A1C1;">@</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0xF002</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// read-only</span></span></code></pre></div><h2 id="let-definitions"><a href="#let-definitions" class="header-anchor">#</a> Let Definitions</h2> <p>A <code>let</code> definition can be used to bind a name to a constant expression. This can reduce the amount of magic numbers appearing in code. These don't require any ROM space where they're defined, but are instead are substituted into whatever expressions that use them.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> name </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> expression</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>The expression of a <code>let</code> definition can be any valid expression. It is recommended to not pass expressions that contain
side-effects. In the future, the compiler may forbid this, but for now this is not validated.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> HP </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> NAME </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;Hello&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>It is also for a <code>let</code> definition to take arguments:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> CEILING_DIV</span><span style="color:#81A1C1;">(</span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">y</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">(</span><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">y</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">y</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> MAP_WIDTH </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">CEILING_DIV</span><span style="color:#81A1C1;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">);</span></span></code></pre></div><h2 id="empty-statement"><a href="#empty-statement" class="header-anchor">#</a> Empty Statement</h2> <p>A single <code>;</code> is allowed anywhere, and is an empty statement. It has no effect.</p> <h2 id="assignment-statement"><a href="#assignment-statement" class="header-anchor">#</a> Assignment Statement</h2> <p>An assignment statement is used to store a value somewhere. Depending on where the value is stored, it can be retrieved again later.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> source</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// assignment</span></span>
<span class="line"><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> source</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// compound assignment</span></span>
<span class="line"><span style="color:#D8DEE9FF;">dest</span><span style="color:#81A1C1;">++;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// post-increment</span></span>
<span class="line"><span style="color:#D8DEE9FF;">dest</span><span style="color:#81A1C1;">--;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// post-decrement</span></span>
<span class="line"><span style="color:#81A1C1;">++</span><span style="color:#D8DEE9FF;">dest</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// pre-increment</span></span>
<span class="line"><span style="color:#81A1C1;">--</span><span style="color:#D8DEE9FF;">dest</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// pre-decrement</span></span></code></pre></div><p>The left-hand side of an assignment <code>=</code> is the destination, which can be a mutable register or a mutable location in memory. The right-hand side of an assignment <code>=</code> is the source, which can be a constant, a register, a readable memory location, or a run-time calculation. The source and destination must be of compatible type, or it is an error.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> max_hp </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> hp</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">damage </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>After constant expression folding, any remaining run-time operations must have instructions available for them. It must be either an exact instruction that does the calcuation and stores it in the destination, or a series of instructions that first load the into the destination, and then modify the destination. For an assignment containing a binary expression like <code>a = b + c;</code>, instruction selection will first look for an exact instruction of form <code>a = b + c;</code>. Failing that, it will attempt decomposing the assignment <code>a = b + c</code> into the form <code>a = b; a = a + c;</code>.</p> <p>Failing that, it is an error, and will probably require the assignment to be manually re-written in terms of multiple assignment statements. Assignments containing run-time operations cannot require an implicit temporary expression, or it is an error.</p> <p>Most expressions are evaluated in left-to-right fashion, and as a result, they must be written so that they can be left-folded without temporaries. This requirement means parenthesized expressions can happen on the left, but the right-hand side will be a constant or simple term.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>// This is OK, because it can be decomposed.
a = (5 + c) - b; 
// The above becomes:
// a = 5;
// a = a + c
// a = a - b;

// This is an error, even in its reduced form:
a = b - (5 + c);
// The above becomes:
// a = b;
// a = a - (5 + c) // the (5 + c) requires a temporary.
</code></pre></div><p>Oftentimes, it won't be possible to assign a value directly to memory. In these cases, the code will need to put an intermediate assignment into a register first, and then store the register into the memory afterwards.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>// If there's no instruction available to assign immediate values to memory, this line will be an error.
hp = 100;

// It must be re-written to use a register in the middle.
// This will work if there is a register named a,
// and there is an instruction to load an immediate to register a,
// and there is another instruction to load memory with the value of the register.
a = 100;
hp = a;
</code></pre></div><p>Assignments can be chained together if they're compatible.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>// This is the same as:
// a = x;
// y = a;
y = a = x;

// This is the same as:
// a = hp;
// a = a - 10;
// hp = a;
hp = a = hp - 10;
</code></pre></div><p>Compound assignment operators exist for most binary arithmetic operations. For some operation <code>+</code>, the statement <code>a += b</code> is the same as writing <code>a = a + b;</code>. If the right-hand side contains a calculation it is implicitly parenthesized, so that <code>a += b + c</code> is the same as <code>a = a + (b + c);</code></p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#616E88;">// same as a = a + 5;</span></span></code></pre></div><p>There are also unary incrementation <code>++</code> and decrementation <code>--</code> operators.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#8FBCBB;">y</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#81A1C1;">++</span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">++</span><span style="color:#8FBCBB;">y</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Sometimes assignments might be used for their side-effects only, such as when writing to an external hardware register. Some such registers are <code>writeonly</code>, which indicates that they cannot be read back later, or that reading back will produce an open-bus value.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9FF;">snes</span><span style="color:#81A1C1;">.</span><span style="color:#D8DEE9FF;">ppu</span><span style="color:#81A1C1;">.</span><span style="color:#D8DEE9FF;">bg_mode </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Similarly, there can be side-effects that occur when reading an external hardware register.</p> <p>Assignments may also result in processor status flag registers being changed as a side-effect. Sometimes, a throw-away calculation in some registers or temporary memory might be performed simply to affect a conditional flag. The effect on flags depends on what sequence of instructions are generated as a result of the assignment. Not every operation affects every flag consistently, due to the design of the processor hardware. Knowing what instructions affect flags and which don't requires some study.</p> <p>A common-to-find flag is the <code>zero</code> flag. If an instruction affects the zero flag, it might be used to indicate whether the result of the last operation was equal to zero. This side-effect can be used sometimes to avoid an extra comparison instruction later.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">do</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">!</span><span style="color:#8FBCBB;">zero</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>A <code>carry</code> flag is a common flag to be affected by arithmetic operations such as addition/subtraction. The interpretation of a <code>carry</code> flag is dependent on the system. There are operations like add with carry <code>+#</code>, subtract with carry <code>-#</code>, rotate left with carry <code>&lt;&lt;&lt;&lt;#</code>, and rotate right with carry <code>&gt;&gt;&gt;&gt;#</code> which depend upon the last state of the <code>carry</code>. These operations can be useful for extending arithmetic operations to work on larger numeric values.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>// add 0x0134 to bc.
c = a = c + 0x34;
b = a = b +# 0x01;
</code></pre></div><p>Some CPUs allow the <code>carry</code> to be set or cleared by assigning to it.</p> <p>Examples:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">carry</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">false;</span></span>
<span class="line"><span style="color:#8FBCBB;">carry</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">true;</span></span></code></pre></div><h2 id="call-statement"><a href="#call-statement" class="header-anchor">#</a> Call Statement</h2> <p>A call statement is a kind of statement that invokes a function. If the function being called produces a return value, the value is discarded. If the function call returns, the code following it will execute. Intrinsic instructions can also be called in the same manner.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#88C0D0;">function</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">argument1</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> argument2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> argument3</span><span style="color:#81A1C1;">);</span></span></code></pre></div><h2 id="block-statement"><a href="#block-statement" class="header-anchor">#</a> Block Statement</h2> <p>A block statement is a scoped section of code that contains a collection of statements. It is started with an opening brace <code>{</code> and must be terminated later with a closing brace <code>}</code>. All declarations within.</p> <p>Many types of statement contain block statements as part of their syntax. For these kinds of statements, the braces delimiting a block statement are not optional, even if only a single statement is present.</p> <h2 id="if-statement"><a href="#if-statement" class="header-anchor">#</a> If Statement</h2> <p>An <code>if</code> statement allows a block of code to be executed conditionally. The condition of an <code>if</code> statement is some expression of type <code>bool</code>. If a condition evaluates to <code>true</code>, then the block directly following it is executed. Otherwise, the block immediately following the condition is skipped, and the next alternative delimited by an <code>else if</code> is evaluated. Finally, there is <code>else</code> when all other alternatives have evaluated to <code>false</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statements</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statements</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statements</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>A conditional expression can be a register term of type <code>bool</code> or its negation, or some combination of multiple <code>bool</code> operands with <code>&amp;&amp;</code> and <code>||</code> operators</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> hp</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">zero</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">dead</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>There are also high-level operators for comparison: <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&gt;</code>, <code>&lt;=</code>. Which kinds of comparisons are possible, and which registers can perform comparisons, depends on the target system.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> gold</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> item_index</span><span style="color:#81A1C1;">;</span></span>

<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&gt;=</span><span style="color:#D8DEE9FF;"> item_cost</span><span style="color:#81A1C1;">[</span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">]</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">-=</span><span style="color:#D8DEE9FF;"> item_cost</span><span style="color:#81A1C1;">[</span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">];</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    gold </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">buy_item</span><span style="color:#81A1C1;">(</span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">);</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">not_enough</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>A conditional statement can also use &quot;side-effect expressions&quot; that evaluate some operation as required before a conditional expression. This sort of &quot;setup-and-test&quot; conditional can make some code read better, used carefully.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> attack </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> defense</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&amp;&amp;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">(</span><span style="color:#8FBCBB;">carry</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">||</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">zero</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">block_attack</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>It is possible to use bit-indexing <code>$</code> to test a single-bit of a value and get its boolean result. Which registers are capable of this, as well as the bits that can be selected, depends on the target system.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">$</span><span style="color:#B48EAD;">7</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">vertical_flip</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">else</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">$</span><span style="color:#B48EAD;">6</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">horizontal_flip</span><span style="color:#81A1C1;">();</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="while-statement"><a href="#while-statement" class="header-anchor">#</a> While Statement</h2> <p>A <code>while</code> statement allows a block of code to be executed conditionally 0 or more times. The block is repeated as long as the condition provided still evaluates to <code>true</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> condition </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> count</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">!</span><span style="color:#8FBCBB;">zero</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">beep</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="do-while-statement"><a href="#do-while-statement" class="header-anchor">#</a> Do/While Statement</h2> <p>A <code>do</code> ... <code>while</code> statement allows a block of code to be executed unconditionally once, followed by conditional execution 0 or more times. The block is entered once, and will repeat more times as long as the condition provided still evaluates to <code>true</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">do</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">while</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Note that <code>do</code> ... <code>while</code> statements are slightly more efficient than <code>while</code> statements, because they fall-through to the next code once the condition is <code>false</code>, and only jump to the top of the loop if the condition is still <code>true</code>.</p> <h2 id="for-statement"><a href="#for-statement" class="header-anchor">#</a> For Statement</h2> <p>A <code>for</code> statement allows iteration over a sequence of values, and executes a block of code for each step through the sequence.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> iterator </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> iterable </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Currently, <code>for</code> loops only support iteration on comple-time integer ranges.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> counter </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> start </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> end </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> counter </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> start </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> end </span><span style="color:#81A1C1;">by</span><span style="color:#D8DEE9FF;"> step </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">x</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">31</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">beep</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p><code>start .. end</code> is an inclusive range. If the loop terminates normally, then after the loop, the counter provided will have the first value that is outside of the sequence.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>// x is a u8 register that can be incremented and decremented.

// x will now be 32.
for x in 0 .. 31 {
    // ...
}

// x will be 0 after the loop.
for x in 31 .. 0 by -1 {
    // ...
}

// x will be 0 after the loop.
for x in 0 .. 255 {
    // ...
}
</code></pre></div><h2 id="return-statements"><a href="#return-statements" class="header-anchor">#</a> Return Statements</h2> <p>A <code>return</code> statement is used to return from the currently executing function.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">return;</span></span>
<span class="line"><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>If used in a function that has no return type, it cannot have a return value. If used in a function that has a return type, the return value must be of the same type.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">collect_egg</span><span style="color:#81A1C1;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> egg_count</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&gt;=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span><span style="color:#81A1C1;">return;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#D8DEE9FF;">    egg_count</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">triple</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">value </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>A <code>return</code> that exists outside of any function body is a low-level <code>return</code> instruction. This would pop a location from the stack and jump there.</p> <h2 id="tail-call-statements"><a href="#tail-call-statements" class="header-anchor">#</a> Tail-Call Statements</h2> <p>A statement of form <code>return f();</code> is a tail-call statement. It gets subsituted for a <code>goto</code>, and avoids the overhead of subroutine call that would push a program counter to the stack. However, unlike a <code>goto</code>, a tail-call will evaluate arguments to a function, like a normal function call.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">call_subroutine</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u16</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">hl</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*func);</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="goto-statements"><a href="#goto-statements" class="header-anchor">#</a> Goto Statements</h2> <p>A <code>goto</code> is a low-level form of branching which jumps to another part of the program. Most high-level control structures are internally implemented in terms of <code>goto</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> destination</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> destination </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>The destination of a <code>goto</code> can be a label, a function, or a function pointer expression.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#8FBCBB;">x</span><span style="color:#81A1C1;">--;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> there </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">zero</span><span style="color:#81A1C1;">;</span></span>

<span class="line"><span style="color:#D8DEE9FF;">loop</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> loop</span><span style="color:#81A1C1;">;</span></span>

<span class="line"><span style="color:#D8DEE9FF;">there</span><span style="color:#81A1C1;">:</span></span></code></pre></div><p>Code that uses <code>goto</code> should ensure that everything is already set up correctly before branching, because <code>goto</code> does not pass any arguments to its destination. If a <code>goto</code> that passes arguments to a function is required, use a tail-call statement of form <code>return f(arg, arg, arg)</code> instead.</p> <h2 id="break-and-continue"><a href="#break-and-continue" class="header-anchor">#</a> Break and Continue</h2> <p>Loop statements such as <code>while</code>, <code>do</code> ... <code>while</code>, <code>for</code> have two forms of branching statements in their blocks: <code>break</code> and <code>continue</code>.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">break;</span></span>
<span class="line"><span style="color:#81A1C1;">continue;</span></span>
<span class="line"><span style="color:#81A1C1;">break</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">continue</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9FF;"> condition</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>A <code>break</code> statement will terminate a loop early, and jump ahead to the code that immediately follows a loop's block.</p> <p>A <code>continue</code> statement will skip to the next iteration of the loop. In <code>for</code> loops, this will skip to the code that performs an increment and branch. In <code>while</code> and <code>do</code> ... <code>while</code> loops, this will skip to the conditional branch of the loop.</p> <h2 id="functions-and-labels"><a href="#functions-and-labels" class="header-anchor">#</a> Functions and Labels</h2> <p>A function is a piece of code that performs a specific set of actions and operations. They can be executed by other parts of the program, and can take arguments and produce a return value.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">f</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">arg </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> arg2 </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> arg3 </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> argument_type3</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> return_type </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">poke</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u16</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">hl</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> value </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">*(</span><span style="color:#D8DEE9FF;">dest </span><span style="color:#81A1C1;">as</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">*u8)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">sum</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">left </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">b</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> right </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">c</span><span style="color:#81A1C1;">)</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">u8</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">return</span><span style="color:#D8DEE9FF;"> left </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> right</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Labels are like functions, but will never return, and cannot be passed arguments. As a low-level detail, labels of form <code>f:</code> are effectively the same thing as an empty-fallthrough function <code>#[fallthrough] func f() {}</code> placed directly before whatever code is executed. A label can be used in any bank that has a known address. (An address is currently required, but eventually, this requirement could relaxed to allow banks which use relative addressing only.)</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#D8DEE9FF;">label</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#81A1C1;">goto</span><span style="color:#D8DEE9FF;"> label</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>Labels or functions can be the target of call expressions, or <code>goto</code> statements.</p> <h2 id="inline-functions"><a href="#inline-functions" class="header-anchor">#</a> Inline Functions</h2> <p>An <code>inline func</code> is like <code>func</code> but inlined directly wherever it is used. As a consequence, the contents of the function are inserted wherever it is called, and the function has no address.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">func</span><span style="color:#D8DEE9FF;"> </span><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">()</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">&lt;&lt;</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#8FBCBB;">a</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#88C0D0;">times_two</span><span style="color:#81A1C1;">();</span></span></code></pre></div><p>An <code>inline func</code> can still <code>return</code>, like a normal function. However, it will not use the stack. Instead, it will jump to a hidden return label that exists at the end of the function.</p> <p>Because an <code>inline func</code> has no address, an <code>inline func</code> cannot be stored in a function pointer, and cannot be branched to from a <code>goto</code> or tail-call statement.</p> <h2 id="inline-for-statement"><a href="#inline-for-statement" class="header-anchor">#</a> Inline For Statement</h2> <p>An <code>inline for</code> allows unrolling a loop at compile-time. The iterator of the loop is optional but exists only for the scope of the <code>inline for</code> block. The value of the iteration at each iteration can be used by expressions within the loop.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> iterator </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> iterable </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> iterable </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    statement</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>Unlike a normal <code>for</code> statement, other iterables like arrays can be used as an iterable.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">hoot</span><span style="color:#81A1C1;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#81A1C1;">);</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">..</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">100</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">nop</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span>

<span class="line"><span style="color:#81A1C1;">inline</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">for</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">let</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">in</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">[</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">,</span><span style="color:#D8DEE9FF;"> </span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">]</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#8FBCBB;">y</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span><span style="color:#88C0D0;">draw</span><span style="color:#81A1C1;">();</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><h2 id="attributes"><a href="#attributes" class="header-anchor">#</a> Attributes</h2> <p>Attributes are a form of special metadata that can be placed before a statement, directive, or declaration. They can provide the compiler with extra details about a particular piece of code.</p> <p>Example:</p> <div class="language- extra-class"><pre><code>#[fallthrough] func lasagna() {
    idx8();
    #[idx8] {
        x = 9;
    }

    idx16();
    #[idx16] {
        xx = 99;
        yy = xx;
    }

    while true {}
}

#[nmi] func vblank() {
    // ...
}

let INCLUDE_THIS_MESSAGE = true;

#[compile_if(INCLUDE_THIS_MESSAGE)] const message = &quot;HI THIS IS A CONDITIONALLY COMPILED MESSAGE&quot;;

</code></pre></div><p>Attributes</p> <ul><li><code>compile_if(condition)</code> - indicates that some code should only be compiled if a particular compile-time boolean condition is <code>true</code>. If the condition is <code>false</code>, the code tagged with the attribute is not emitted.</li> <li><code>fallthrough</code> - indicates the function might fall through into the immediately following code, and disables the implicit return at the end of the function. Useful for tagging functions that are guaranteed to never return, or functions that are meant to fall into some other code afterwards.</li> <li><code>nmi</code> - indicates that a function handles a non-maskable interrupt request. All <code>return;</code> instructions will be translated into <code>nmireturn;</code> instead. (eg. <code>rti</code> on 6502, <code>retn</code> on Z80)</li> <li><code>irq</code> - indicates that a function handles a maskable interrupt request. All <code>return;</code> instructions will be translated into <code>irqreturn;</code> instead.  (eg. <code>rti</code> on 6502, <code>reti</code> on Z80)</li></ul> <p>65816 Attributes</p> <ul><li><code>mem8</code> - assumes the tagged statements will be using an 8-bit accumulator and main memory-related instructions. (eg. accumulator arithmetic, storing/loading from accumulator, bit-shifting accumulator/memory)</li> <li><code>mem16</code> - assumes the tagged statements will be using an 16-bit accumulator and main memory-related instructions.  (eg. accumulator arithmetic, storing/loading from accumulator, bit-shifting accumulator/memory)</li> <li><code>idx8</code> - assumes the tagged statements will be using 8-bit index registers and indexing-related instructions. (eg. indexing, storing/loading from index registers, push/pop)</li> <li><code>idx16</code> - assumes the tagged statements will be using 16-bit index registers and indexing-related instructions.  (eg. indexing, storing/loading from index registers, push/pop)</li></ul> <h2 id="config-directives"><a href="#config-directives" class="header-anchor">#</a> Config Directives</h2> <p>Depending on the output file format selected for the program, there are extra options that can be configured.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">config</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">{</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    option </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> value</span><span style="color:#81A1C1;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    option </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> value</span><span style="color:#81A1C1;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    option </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> value</span></span>
<span class="line"><span style="color:#81A1C1;">}</span></span></code></pre></div><p>See Formats section for possible options.</p> <h2 id="types"><a href="#types" class="header-anchor">#</a> Types</h2> <p>Built-in Types:</p> <div class="language- extra-class"><pre><code>// Boolean
bool
// Compie-time integer expression (&quot;arbitrary precision&quot;, unknown size, but currently 128-bit)
iexpr
// Unsigned sized integer
u8
u16
u24
u32
u64
// Signed sized integer
i8
i16
i24
i32
i64
</code></pre></div><p>Array Types:</p> <div class="language- extra-class"><pre><code>// Array. eg. [u8; 100]
[T; N]
// Implicitly-sized array type. (size determined by initializer)
[T]
</code></pre></div><p>Designated Storage Types:</p> <div class="language- extra-class"><pre><code>// Designated storage for parameter-passing and named locals.
// eg. u8 in a
T in expr
</code></pre></div><p>User-defined types:</p> <div class="language- extra-class"><pre><code>// Structure. Data members have increasing start addresses.
struct Point {
    x : u8,
    y : u8
}

// Union. Data members have the same start address.
union Union {
    byte : u8,
    word : u16
}

// Enum. A strongly-typed enumeration type.
// Uses the same storage as its underlying type.
// It cannot be used as integer without casting.
enum ItemType : u8 {
    Consumable,
    Key,    
    Weapon,
    Armor,
    Accessory,
}

// Type alias. Gives another name to the same type.
// A typealias is interchangable with the type it aliases.
typealias byte = u8;
</code></pre></div><h2 id="expressions"><a href="#expressions" class="header-anchor">#</a> Expressions</h2> <div class="language- extra-class"><pre><code>    (a) // parentheses

    -a // signed negation. integer
    +a // signed identity. integer

    // Arithmetic operators.
    // integer + integer -&gt; integer
    a + b // add. integer + integer -&gt; integer
    a +# b // add with carry. integer +# integer -&gt; integer
    a - b // subtract. integer - integer -&gt; integer
    a -# b // subtract with carry. integer -# integer -&gt; integer
    a * b // multiply. integer * integer -&gt; integer
    a / b // divide. integer / integer -&gt; integer
    a % b // modulo. integer % integer -&gt; integer
    a &lt;&lt; b // arithmetic left shift. integer &lt;&lt; integer -&gt; integer
    a &gt;&gt; b // arithmetic right shift. integer &gt;&gt; integer -&gt; integer
    a &lt;&lt;&lt; b // logical left shift. integer &lt;&lt;&lt; integer -&gt; integer
    a &gt;&gt;&gt; b // logical right shift. integer &gt;&gt;&gt; integer -&gt; integer
    a &lt;&lt;&lt;&lt; b // left rotate (N bits). integer &lt;&lt;&lt;&lt; integer -&gt; integer
    a &gt;&gt;&gt;&gt; b // right rotate (N bits). integer &gt;&gt;&gt;&gt; integer -&gt; integer
    a &lt;&lt;&lt;&lt;# b // left rotate with carry (N+1 bits). integer &lt;&lt;&lt;&lt;# integer -&gt; integer
    a &gt;&gt;&gt;&gt;# b // right rotate with carry (N+1 bits). integer &gt;&gt;&gt;&gt;# integer -&gt; integer

    // Logical operators.
    !a // logical negation. bool
    a &amp;&amp; b // logical and. bool &amp;&amp; bool -&gt; bool
    a || b // logical or. bool || bool -&gt; bool

    ~a // bitwise negation. integer | integer -&gt; integer
    a &amp; b // bitwise and. integer | integer -&gt; integer
    a | b // bitwise or. integer | integer -&gt; integer
    a ^ b // bitwise xor. integer ^ integer -&gt; integer
    a $ b // bit indexing. integer $ integer -&gt; bool
    &lt;:a // low byte access (bits 0 .. 7). integer -&gt; u8
    &gt;:a // high byte access (bits 8 .. 15). integer -&gt; u8
    #:a // bank byte access (bits 16 .. 23). integer -&gt; u8

    a++ // post-increment. integer
    a-- // post-decrement. integer
    ++a // pre-increment. integer
    --a // pre-decrement. integer

    *a // indirection. *T -&gt; T
    &amp;a // address of. term must be an addressable l-value. T -&gt; *T
    a[n] // indexing. returns the nth element of a. Possibly the nth item from its start address.
    a.b // member access.

    a as T // cast operator.

    f(a, b, c, d) // call.

    1 // unsized integer expression. iexpr
    1u8 // integer with size suffix. in this case, u8

    &quot;hello&quot; // string literal. [u8; N]
    [expr for let iterator in iterable] // array comprehension. [T; N]
    [expr; size] // array pad literal. [T; N]
    [expr, expr, expr] // array literal. [T; N]
    (a, b, c, d) // tuple literal (reserved but not implemented yet). (T, T2, T3, ..., TN)

    a ~ b // concatenation [T; M] ~ [T; N] -&gt; [T; M + N]
</code></pre></div><h2 id="imports"><a href="#imports" class="header-anchor">#</a> Imports</h2> <p>To include another file in the program, use <code>import</code> directives.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;path&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div><p>The path is a string literal. This path is the name of the .wiz file, without its extension.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;nes&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;magic&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div><h2 id="embeds"><a href="#embeds" class="header-anchor">#</a> Embeds</h2> <p>To include a binary asset, use <code>embed</code> expressions.</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">embed</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;path&quot;</span></span></code></pre></div><p>The path passed to an <code>embed</code> should include the file extension. The contents of the embedded file are loaded into compiler memory and cached, and then inserted verbatim as a <code>[u8]</code> expression anywhere they are embedded.</p> <p>Example:</p> <div class="language-wiz extra-class"><pre class="shiki" style="background-color:#2e3440ff;"><code><span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9FF;"> data </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> </span><span style="color:#81A1C1;">embed</span><span style="color:#D8DEE9FF;"> </span><span style="color:#A3BE8C;">&quot;hero.chr&quot;</span><span style="color:#81A1C1;">;</span></span></code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/usage.html" class="prev">
        Using Wiz
      </a></span> <span class="next"><a href="/guides/syntax.html">
        Syntax
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fbc1217a.js" defer></script><script src="/assets/js/2.ace28840.js" defer></script><script src="/assets/js/15.4eb04e4c.js" defer></script>
  </body>
</html>
